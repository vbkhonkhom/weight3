# 🚀 เริ่มต้นใช้งาน (สำหรับผู้ใช้ทั่วไป)

> **สำหรับคนที่ไม่มีความรู้ทางคอมพิวเตอร์** - อธิบายทีละขั้นตอนแบบละเอียด

---

## 📌 ก่อนเริ่มต้น

คุณต้องมี:
- ✅ Google Account (Gmail)
- ✅ Google Sheets ที่มีข้อมูล WTH Fitness
- ✅ เปิดใช้งาน Google Sheets ได้

---

## 🎯 ขั้นตอนที่ 1: อัปเดตโค้ด (ทำแค่ครั้งเดียว)

### 1.1 เปิด Google Sheets
1. เปิด Browser (Chrome, Edge, Safari)
2. ไปที่ Google Sheets ของคุณ
3. เปิดไฟล์ **WTH Fitness**

### 1.2 เข้า Apps Script
1. ที่แถบบนสุด มองหา **Extensions** (ถ้าเป็นภาษาไทยจะเป็น "ส่วนขยาย")
2. คลิก **Extensions**
3. เลือก **Apps Script**

จะเปิดหน้าต่างใหม่ขึ้นมา มีโค้ดเยอะ ๆ อยู่

### 1.3 ลบโค้ดเก่า
1. กดปุ่ม **Ctrl+A** (Windows) หรือ **Cmd+A** (Mac)
   - ทั้งหน้าจอจะไฮไลท์สีน้ำเงิน
2. กด **Delete** หรือ **Backspace**
   - โค้ดเก่าหายหมด จะเหลือหน้าว่าง ๆ

### 1.4 คัดลอกโค้ดใหม่
1. เปิดโฟลเดอร์โปรเจค → **apps-script** → เปิดไฟล์ **main.gs**
2. กด **Ctrl+A** (เลือกทั้งหมด)
3. กด **Ctrl+C** (คัดลอก)

### 1.5 วางโค้ดใหม่
1. กลับไปหน้าต่าง Apps Script (ที่ว่าง ๆ อยู่)
2. คลิกในหน้าว่าง
3. กด **Ctrl+V** (วาง)
   - จะเห็นโค้ดเยอะ ๆ ปรากฏขึ้นมา

### 1.6 บันทึก
1. หาปุ่ม **💾 Save** (หรือไอคอนรูปฟล็อปปี้ดิสก์)
2. คลิก
3. รอจน Loading หมด
4. **ปิดหน้า Apps Script** (แท็บนี้)
5. **กลับมาที่ Google Sheets**

---

## 🎯 ขั้นตอนที่ 2: Refresh และตั้งค่า

### 2.1 Refresh Google Sheets
1. กด **F5** (Windows) หรือ **Cmd+R** (Mac)
2. หรือคลิกปุ่ม Reload บน Browser

### 2.2 ตรวจสอบเมนูใหม่
มองที่แถบบนสุด จะเห็นเมนู:
```
File  Edit  View  Insert  Format  Data  Tools  Extensions  Help  [🏋️ WTH Fitness] ← ตัวนี้!
```

ถ้าเห็น **🏋️ WTH Fitness** แสดงว่าสำเร็จ!

### 2.3 ตั้งค่าครั้งแรก
1. คลิก **🏋️ WTH Fitness**
2. เลื่อนไปที่ **⚙️ ตั้งค่าระบบ**
3. คลิก **🔧 ตั้งค่าทั้งหมดพร้อมกัน**

จะมีหน้าต่างขึ้นมาขอ Permission:

### 2.4 ให้สิทธิ์ (Authorization)
1. คลิก **Review Permissions** (หรือ "ตรวจสอบสิทธิ์")
2. เลือก Google Account ของคุณ
3. จะขึ้นข้อความเตือน "Google hasn't verified this app"
4. คลิก **Advanced** (ขั้นสูง)
5. คลิก **Go to [ชื่อโปรเจค] (unsafe)** (ไปที่... ไม่ปลอดภัย)
6. คลิก **Allow** (อนุญาต)

**รอสักครู่...** (10-20 วินาที)

จะขึ้นข้อความ:
```
Application setup completed
```

เสร็จแล้ว! คลิก **OK**

---

## 🎯 ขั้นตอนที่ 3: ตั้งค่า API Key

### 3.1 เข้าเมนู
1. คลิก **🏋️ WTH Fitness**
2. เลื่อนไปที่ **🔐 API Settings**
3. คลิก **🔑 ตั้งค่า API Key**

### 3.2 ใส่รหัส
1. จะมีกล่องให้ใส่รหัส
2. ใส่รหัสที่ต้องการ (เช่น `WTHFitness2025Secret`)
   - **ข้อแนะนำ**: ใช้ตัวอักษร+ตัวเลข ยาว 15-20 ตัว
   - **อย่าใช้**: 123456, password, admin
3. **จดรหัสนี้ไว้!** (จะใช้ตอนตั้ง Next.js)
4. คลิก **OK**

จะขึ้นข้อความ:
```
✅ ตั้งค่า API Key สำเร็จ!
```

---

## 🎯 ขั้นตอนที่ 4: Deploy Web App

### 4.1 เข้า Apps Script อีกครั้ง
1. **Extensions → Apps Script**

### 4.2 Deploy
1. หาปุ่ม **Deploy** (ด้านบนขวา)
2. คลิก **Deploy → New deployment**

### 4.3 ตั้งค่า Deployment
จะมีหน้าต่างขึ้นมา:

1. **Select type**: เลือก **Web app**
2. **Description**: ใส่ชื่อ (เช่น "WTH Fitness API v1")
3. **Execute as**: เลือก **Me** (ตัวคุณเอง)
4. **Who has access**: เลือก **Anyone**
5. คลิก **Deploy**

### 4.4 Authorization (อีกครั้ง)
1. คลิก **Authorize access**
2. เลือก Account
3. คลิก **Allow**

### 4.5 คัดลอก URL
จะมีหน้าต่างแสดง:
```
Web app URL: https://script.google.com/macros/s/AKfycby.../exec
```

1. **คลิกปุ่ม Copy** (📋)
2. **จด URL นี้ไว้!** (จะใช้กับ Next.js)
3. คลิก **Done**
4. **ปิดหน้า Apps Script**

---

## ✅ เสร็จแล้ว! ตอนนี้คุณมี:

- ✅ โค้ด Apps Script ใหม่
- ✅ เมนู 🏋️ WTH Fitness ใน Google Sheets
- ✅ API Key (รหัสลับ)
- ✅ Web App URL (ที่อยู่ API)

---

## 🎮 วิธีใช้งานประจำวัน

### ดูว่าใช้พื้นที่ไปเท่าไหร่แล้ว
```
🏋️ WTH Fitness → 📊 จัดการข้อมูล → 📈 ดูสถิติการใช้พื้นที่
```
จะเห็นสถิติแบบนี้:
- ใช้ไปแล้ว: 2,345,678 เซลล์
- เหลือ: 7,654,322 เซลล์
- สถานะ: ✅ ปกติ / ⚠️ เกือบเต็ม

### เมื่อใช้พื้นที่เกิน 70%
```
🏋️ WTH Fitness → 📊 จัดการข้อมูล → 📦 Archive ข้อมูลเก่า
```
1. เลือกวันที่: เช่น 6 เดือนก่อน (2024-04-01)
2. เลือก Sheets: ✅ TestResults ✅ BodyMeasurements
3. คลิก **🚀 เริ่ม Archive**
4. รอจนเสร็จ (จะขึ้นข้อความ "✅ สำเร็จ!")

**ข้อมูลจะไปอยู่ที่**: Sheet ชื่อ `Archive_2025_10`

### ถ้ามีข้อมูลซ้ำ
```
🏋️ WTH Fitness → 📊 จัดการข้อมูล → 🧹 ลบข้อมูลซ้ำ
```
1. เลือก Sheet: TestResults
2. คลิก **🧹 เริ่มลบข้อมูลซ้ำ**
3. ยืนยัน
4. เสร็จ!

### ต้องการลบข้อมูลเก่า (ระวัง!)
```
🏋️ WTH Fitness → 📊 จัดการข้อมูล → 🗑️ ลบข้อมูลเก่า
```
⚠️ **คำเตือน**: ลบแล้วกู้คืนไม่ได้!

1. เลือก Sheet: TestResults
2. เลือกวันที่: 2024-01-01 (ลบก่อนวันนี้)
3. **เก็บล่าสุด**: 10 ← สำคัญ! (เก็บ 10 รายการล่าสุดของแต่ละคน)
4. คลิก **🗑️ ลบข้อมูล**
5. อ่านข้อความยืนยันให้ดี
6. คลิก **ยืนยัน**

---

## ❓ แก้ปัญหาเบื้องต้น

### ไม่เห็นเมนู 🏋️ WTH Fitness
**แก้**: 
1. กด **F5** (Refresh)
2. ยังไม่เห็น → ปิด Browser แล้วเปิดใหม่
3. ยังไม่เห็น → ทำขั้นตอนที่ 1 ใหม่

### กดเมนูแล้วไม่มีอะไรเกิดขึ้น
**แก้**:
1. รอ 5-10 วินาที (อาจจะช้า)
2. กด F5 แล้วลองใหม่
3. ตรวจสอบว่าให้ Permission แล้วหรือยัง

### ขึ้นข้อความ "ไม่พบ Sheet"
**แก้**:
```
🏋️ WTH Fitness → ⚙️ ตั้งค่าระบบ → 📋 สร้างตารางทั้งหมด
```

### ขึ้นข้อความ "Unauthorized"
**แก้**:
1. ตรวจสอบว่าตั้ง API Key หรือยัง
2. Deploy Web App ใหม่

### Archive แล้วข้อมูลหายไป?
**คำตอบ**: ไม่หายค่ะ! อยู่ใน Sheet ชื่อ **Archive_YYYY_MM**

ดูโดย:
1. ที่แถบล่างของ Google Sheets
2. มองหา Tab ชื่อ `Archive_2025_10`
3. คลิกเพื่อดูข้อมูล

---

## 📞 ต้องการความช่วยเหลือ?

### ขั้นตอนที่ 1: ตรวจสอบเอง
1. อ่านคู่มือนี้ให้ครบ
2. ดู Error log (ถ้ามี)
3. ลอง Refresh และทำใหม่

### ขั้นตอนที่ 2: ดูคู่มือในระบบ
```
🏋️ WTH Fitness → ❓ คู่มือการใช้งาน
```

### ขั้นตอนที่ 3: ติดต่อทีมพัฒนา
- แจ้งปัญหาพร้อมภาพหน้าจอ
- บอกว่าทำขั้นตอนไหนค้าง

---

## 📅 ตารางบำรุงรักษา (แนะนำ)

| ความถี่ | งานที่ควรทำ | วิธีทำ |
|---------|-------------|--------|
| **ทุกสัปดาห์** | ดูสถิติพื้นที่ | 📊 → 📈 ดูสถิติ |
| **ทุกเดือน** | ลบข้อมูลซ้ำ | 📊 → 🧹 ลบซ้ำ |
| **ทุก 6 เดือน** | Archive ข้อมูลเก่า | 📊 → 📦 Archive |
| **ทุกปี** | ลบข้อมูลเก่ามาก | 📊 → 🗑️ ลบเก่า |

---

## 💡 Tips & Tricks

### 1. Bookmark เมนูที่ใช้บ่อย
คุณจะใช้เมนู **📈 ดูสถิติ** บ่อยที่สุด

### 2. Archive เป็นวิธีที่ปลอดภัยที่สุด
- ข้อมูลไม่หาย
- ลดพื้นที่ได้
- กู้คืนได้ง่าย

### 3. ใช้ "เก็บล่าสุด" เมื่อลบข้อมูล
- ตั้งเป็น 10-20 รายการ
- แต่ละคนจะเหลือล่าสุด 10-20 รายการ
- ปลอดภัยกว่าลบหมด

### 4. Export ข้อมูลสำคัญก่อนลบ
- File → Download → Excel (.xlsx)
- เก็บไฟล์ไว้เป็น Backup

---

## 🎓 คำศัพท์ที่ควรรู้

| คำศัพท์ | ความหมาย |
|---------|----------|
| **Sheet** | แผ่นงานใน Google Sheets (เหมือนแท็บ) |
| **Archive** | เก็บไว้ที่แยก ไม่ลบทิ้ง |
| **API Key** | รหัสลับสำหรับเชื่อมต่อ |
| **Deploy** | เผยแพร่ให้ใช้งานได้ |
| **Permission** | การขออนุญาต |
| **เซลล์ (Cell)** | ช่องเดียวในตาราง |

---

**🏋️ WTH Fitness App**

ถ้าทำตามคู่มือนี้ครบ คุณจะใช้งานระบบได้เต็มรูปแบบ  
**ไม่ต้องเข้า Apps Script อีกเลย!** ทำทุกอย่างผ่านเมนูได้หมด 🎉

---

*สร้างโดยทีมพัฒนา WTH Fitness*  
*เวอร์ชัน 2.0 - ตุลาคม 2025*
