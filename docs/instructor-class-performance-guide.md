# คู่มือการอ่านตารางสมรรถภาพและสัดส่วน (Instructor Class Performance)

คู่มือนี้อธิบายที่มาของข้อมูลในหน้ารายชื่อนักเรียน (Instructor › Class Detail) เวอร์ชันที่อัปเดตใหม่ รวมถึงโครงสร้างไฟล์ CSV ที่ส่งออก เพื่อให้ผู้สอนเข้าใจว่าคะแนนรวมมาจากไหน ค่าต่าง ๆ หมายถึงอะไร และจะตีความผลลัพธ์ได้อย่างไร

---

## 1. ภาพรวมหน้ารายชื่อนักเรียน

หน้ารายชื่อถูกแบ่งเป็น **สองโหมด** ที่เลือกสลับได้จากปุ่มภายในตาราง

| โหมด | คำอธิบาย | ใช้เมื่อ |
| --- | --- | --- |
| **สมรรถภาพ** | แสดงค่า “ผลทดสอบล่าสุด” ทั้ง 5 ด้าน พร้อมผลการประเมิน (ดีมาก / ดี / ปานกลาง / ต้องพัฒนา) | ต้องการดูความแข็งแรงและสมรรถภาพรวมของแต่ละคนในรอบทดสอบล่าสุด |
| **สัดส่วน** | แสดงค่าการวัดสัดส่วนร่างกายล่าสุด (อัตโนมัติเลือกช่วง After ถ้ามี) | ต้องการติดตามความเปลี่ยนแปลงด้านรูปร่าง น้ำหนัก หรือการวัดเฉพาะส่วน |

ค่าทั้งหมดอัปเดตจาก Google Sheets อัตโนมัติเมื่อบันทึกผลทดสอบหรือกรอกแบบฟอร์มวัดสัดส่วนโดยใช้แอป/สคริปต์ที่เชื่อมกับระบบ

---

## 2. โครงสร้างข้อมูลในโหมดสมรรถภาพ

### 2.1 ค่าที่แสดง

| คอลัมน์ | แหล่งข้อมูล | วิธีคำนวณ / หน่วย |
| --- | --- | --- |
| **Muscular Strength** | ผลทดสอบ `hand_grip` (แรงบีบมือ) | น้ำหนักที่บีบได้ หารด้วยน้ำหนักตัว (กก.) จะได้ค่า ratio ที่แสดงในตาราง |
| **Muscular Endurance** | ผลทดสอบ `chair_stand` | จำนวนครั้งที่ลุกนั่งในเวลาที่กำหนด (ครั้ง) |
| **Flexibility** | ผลทดสอบ `sit_and_reach` | ระยะเอื้อม (ซม.) |
| **%Fat** | คำนวณจาก BMI ล่าสุด หรือค่าที่บันทึกไว้ในสัดส่วน | สูตรโดยประมาณ *(BMI − 18.5) × 2 + 15* และจำกัดให้อยู่ระหว่าง 5–50% |
| **Cardio - Respiratory Endurance** | ผลทดสอบ `step_up` | จำนวนก้าวหรือคะแนนจากการขึ้นลงบันไดในรอบล่าสุด |

ทุกคอลัมน์จะแสดง **ค่าตัวเลข** และ **ผลการประเมิน** ตามเกณฑ์มาตรฐาน (ดีเยี่ยม / ดี / ปานกลาง / ต้องพัฒนา) ที่ผูกกับแต่ละการทดสอบ

### 2.2 คะแนนรวม (Overall Score)

คะแนนรวมใช้เพื่อจัดลำดับความโดดเด่นของนักเรียนในชั้น โดยคำนวณจากค่าเฉลี่ยของคะแนนย่อย 5 การทดสอบดังนี้

1. ดึงค่าจากผลทดสอบล่าสุดของแต่ละประเภท (BMI, Sit & Reach, Hand Grip, Chair Stand, Step Up)  
2. แปลงเป็นคะแนนย่อย (0–100)  
   - **BMI**  
     - 18.5 – 24.9 ⇒ 100 คะแนน  
     - 17 – <18.5 ⇒ 80 คะแนน  
     - >24.9 – 29.9 ⇒ 70 คะแนน  
     - นอกช่วง ⇒ 50 คะแนน  
   - **รายการอื่น** ⇒ จำกัดค่าอยู่ใน 0–100 ด้วยสูตร `min(100, max(0, value × 10))`  
3. ค่าเฉลี่ยของคะแนนย่อยทั้ง 5 คือ **Overall Score**  
4. แปลงคะแนนรวมเป็นระดับผลงาน  
   - ≥ 90 ⇒ ดีเยี่ยม  
   - ≥ 80 ⇒ ดี  
   - ≥ 70 ⇒ ปานกลาง  
   - < 70 ⇒ ต้องพัฒนา

> **หมายเหตุ**: หากไม่มีผลทดสอบครบทุกด้าน ค่าที่ขาดจะไม่ถูกนำมาคิด แต่คะแนนรวมจะตั้งเป็น 0 และระดับผลงานเป็น “ต้องพัฒนา” เพื่อเน้นว่าไม่มีข้อมูลพอประเมิน

---

## 3. โครงสร้างข้อมูลในโหมดสัดส่วน

ระบบจะเลือกข้อมูลจากการวัดสัดส่วนที่ **ล่าสุด** โดยให้ความสำคัญกับช่วง `after` ถ้ามี หากไม่มีจะใช้ `before` แทน

| คอลัมน์ | หน่วย | หมายเหตุ |
| --- | --- | --- |
| น้ำหนัก | กก. | |
| ส่วนสูง | ซม. | |
| ชีพจร | ครั้ง/นาที | |
| รอบคอ, รอบอก, หน้าท้อง, รอบเอว, รอบสะโพก | ซม. | |
| หัวไหล่ขวา/ซ้าย, แขนท่อนบนขวา/ซ้าย, ข้อมือขวา/ซ้าย | ซม. | |
| ต้นขาขวา/ซ้าย, น่องขวา/ซ้าย, ข้อเท้าขวา/ซ้าย | ซม. | |

หากค่าใดไม่มีการบันทึกจะเว้นว่าง (`-`) ภายในตารางและไฟล์ CSV

---

## 4. ไฟล์ CSV ที่ส่งออก

การกด **ส่งออก CSV** จะได้ไฟล์ที่มีโครงสร้างเดียวกับตัวอย่างต่อไปนี้ (มีการเติม BOM เพื่อให้ Excel เปิดภาษาไทยไม่เพี้ยน)

```
=== สรุปสถิติกลุ่มเรียน สมาชิกกลุ่ม 1 ===

ข้อมูลเฉลี่ย,ค่า (หน่วย)
Muscular Strength,68.2
...

ข้อมูลผู้ประเมิน,,,,"สมรรถภาพทางกาย",,,,,,"สัดส่วนร่างกาย",,,,,,,,,,,,,,,,,"ระดับผลงาน","วันที่ทดสอบล่าสุด"
ชื่อ-สกุล,อีเมล,อายุ,เพศ,คะแนนรวม,Muscular Strength,ผลการประเมิน,...,น้ำหนัก,ส่วนสูง,...,ระดับผลงาน,วันที่ทดสอบล่าสุด
ยศพล แสงอินทร์,okeza44@gmail.com,22,ชาย,74,"98","ดีมาก",...,"78","174",...,"ดีมาก","2025-10-28"
```

### จุดสำคัญ

1. **ช่วงหัวรายงาน** (ก่อนบรรทัดหัวตาราง) สรุปค่าเฉลี่ยของแต่ละการทดสอบ, อายุเฉลี่ย, ชื่อผู้ที่มีคะแนนสูงสุดและต่ำสุด  
2. **คอลัมน์ “คะแนนรวม”** ถูกเพิ่มไว้หน้าเซ็ตสมรรถภาพ เพื่อสะดวกในการจัดอันดับใน Excel  
3. **ผลการประเมิน** ใช้ข้อความเดียวกับในหน้าจอ (ดีเยี่ยม / ดี / ปานกลาง / ต้องพัฒนา)  
4. วันที่ทดสอบล่าสุดอยู่ในรูปแบบ `YYYY-MM-DD` เพื่อให้นำไปจัดการต่อได้ง่าย

---

## 5. ข้อควรทราบ

1. หากยังไม่เคยบันทึกผลทดสอบเลย นักเรียนคนนั้นจะขึ้นคะแนนรวมเป็น `0` และระดับผลงาน “ต้องพัฒนา”  
2. สูตรคำนวณ %Fat ที่ระบบใช้เป็นค่าโดยประมาณ เพื่อให้เห็นแนวโน้มเบื้องต้นเท่านั้น หากต้องการค่าที่แม่นยำควรบันทึกค่าจากเครื่องวัดไขมันโดยตรง  
3. หากเกณฑ์การประเมินใน Google Sheets ถูกแก้ไข ค่าผลการประเมินในระบบจะเปลี่ยนตามทันทีโดยไม่ต้องปรับโค้ด  
4. มุมมองสัดส่วนจะแสดงเฉพาะค่าที่มีในแบบฟอร์ม `Body Measurements` เท่านั้น หากต้องการส่วนอื่นเพิ่มให้ปรับหัวตารางในชีตและอัปเดตสคริปต์ตามลำดับ

---

## 6. สรุปวิธีใช้งานอย่างรวดเร็ว

1. เปิดหน้ารายชื่อและเลือกโหมด  
   - ต้องการดูสมรรถภาพล่าสุด ⇒ เลือก *สมรรถภาพ*  
   - ต้องการดูการวัดสัดส่วน ⇒ เลือก *สัดส่วน*  
2. วางเมาส์ที่หัวคอลัมน์และคลิกเพื่อเรียงลำดับ (ชื่อ, อายุ, คะแนนรวม, วันที่สอบล่าสุด)  
3. กด **ส่งออก CSV** เพื่อเก็บข้อมูลไว้ทำรายงาน หรือส่งให้ผู้ปกครอง/ผู้บริหาร  
4. ใช้คู่มือนี้ประกอบเพื่ออธิบายว่าแต่ละค่าได้มาอย่างไร และควรตีความผลอย่างไร

หากมีคำถามเพิ่มเติมเกี่ยวกับการตั้งค่าเกณฑ์หรือการคำนวณคะแนน สามารถดูเอกสาร `docs/instructor-guide.md` หรือสอบถามทีมพัฒนาระบบได้ตลอดเวลา
